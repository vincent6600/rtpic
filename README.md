# RTPic 提示词优化功能 - 完整部署包

## 📦 文件清单

此包包含为您的 RTPic 项目添加完整提示词优化功能的修改文件：

### 🔧 核心文件

1. **`prompt_system.txt`** - 独立的角色提示词文件
   - 可独立修改和定制
   - 专门针对电商产品主图优化

2. **`index.html`** - 修改后的主HTML文件
   - 添加了4个"提示词优化"按钮
   - 保持原有UI结构完整

3. **`style.css`** - 修改后的样式文件
   - 添加了优化按钮的完整样式
   - 支持深色/浅色主题自适应
   - 响应式设计适配移动端

4. **`script.js`** - 修改后的JavaScript文件
   - 实现了完整的提示词优化功能
   - 空格触发检测机制
   - API调用和错误处理
   - 多模型适配逻辑

## 🚀 部署步骤

### 第一步：备份原始文件
```bash
# 进入您的项目目录
cd /Users/Vincent/Downloads/nanobanana-modified\ 2.0\ 正式

# 备份原始文件
cp static/index.html static/index.html.backup
cp static/style.css static/style.css.backup
cp static/script.js static/script.js.backup
```

### 第二步：上传新文件
1. **将 `prompt_system.txt` 上传到项目根目录**
   ```
   /Users/Vincent/Downloads/nanobanana-modified 2.0 正式/prompt_system.txt
   ```

2. **替换 static 目录下的文件**
   - 用新的 `index.html` 替换 `static/index.html`
   - 用新的 `style.css` 替换 `static/style.css`
   - 用新的 `script.js` 替换 `static/script.js`

### 第三步：重新部署
```bash
# 重新部署到 Deno Deploy
deno deploy --project=your-project-name
```

## ✨ 功能特性

### 🎯 提示词优化按钮
- **位置**：每个提示词输入框右侧
- **样式**：精美的渐变按钮，支持主题切换
- **交互**：悬停效果、加载状态、成功/错误状态

### ⌨️ 空格触发功能
- **触发条件**：连续输入三个空格
- **视觉反馈**：显示"🚀 激活提示词优化"提示
- **自动执行**：自动触发优化功能

### 🧠 智能优化逻辑
- **API优化**：使用 Claude-3.5-sonnet 进行专业优化
- **本地降级**：API失败时使用本地优化算法
- **多模型适配**：
  - ChatGPT/Nano Banana：保持中文优化
  - ModelScope：添加质量关键词
  - Flux/Kontext/Krea：自动翻译为英文

### 🌍 多语言支持
- **界面语言**：中文
- **错误提示**：中文
- **优化策略**：根据模型特性调整语言

### 📱 响应式设计
- **桌面端**：完整功能体验
- **移动端**：自适应布局和交互
- **主题切换**：深色/浅色模式完全支持

## 🔑 API 配置

### OpenRouter API
项目使用您现有的 OpenRouter API 配置：
- **环境变量**：`OPENROUTER_API_KEYS`
- **调用模型**：`anthropic/claude-3.5-sonnet`
- **API端点**：`https://openrouter.ai/api/v1/chat/completions`

### 密钥管理
- 从 localStorage 自动加载现有密钥
- 支持多密钥负载均衡
- 安全存储在浏览器本地

## 🎨 角色提示词定制

### 文件位置
`prompt_system.txt` - 独立的角色提示词文件

### 定制方法
1. 直接编辑 `prompt_system.txt` 文件
2. 修改优化维度和策略
3. 调整输出格式要求
4. 保存后刷新页面即可生效

### 优化维度
1. **产品特征**：材质、质感、细节描述
2. **光线效果**：专业摄影级光线设置
3. **背景设计**：简洁专业的背景场景
4. **拍摄角度**：最佳展示角度
5. **构图布局**：电商展示构图
6. **色彩搭配**：和谐色彩方案
7. **质感提升**：高端质感突出
8. **电商适配**：平台要求适配

## 🛠️ 技术实现

### 前端架构
- **原生JavaScript**：无框架依赖
- **模块化设计**：功能分离，易于维护
- **事件驱动**：完善的事件处理系统
- **状态管理**：集中式状态管理

### API集成
- **统一管理**：`ApiManager` 类
- **错误处理**：完善的异常捕获和用户反馈
- **超时控制**：30秒超时和重试机制
- **降级方案**：API失败时自动使用本地优化

### 用户体验
- **即时反馈**：优化状态实时显示
- **防抖机制**：防止频繁触发
- **加载指示**：清晰的加载状态
- **错误恢复**：友好的错误提示

## 📋 使用指南

### 基本使用
1. **输入提示词**：在任意提示词输入框中输入内容
2. **点击优化**：点击右侧"提示词优化"按钮
3. **查看结果**：自动替换为优化后的提示词
4. **继续生成**：使用优化后的提示词进行图片生成

### 高级功能
1. **空格触发**：连续输入三个空格自动优化
2. **多模型支持**：支持所有6个AI模型
3. **历史记录**：自动保存优化历史
4. **参数记忆**：记住每个模型的设置

### 快捷键
- **Cmd/Ctrl + K**：聚焦到当前模型的API密钥输入
- **Cmd/Ctrl + Enter**：快速生成图片
- **连续三个空格**：激活提示词优化

## 🔧 故障排除

### 常见问题

**Q: 优化按钮不显示？**
A: 检查HTML文件是否正确替换，确保CSS文件也更新了

**Q: 优化功能无响应？**
A: 检查浏览器控制台是否有错误，确认OpenRouter API密钥配置正确

**Q: 空格触发不工作？**
A: 确认script.js文件已更新，检查事件监听器是否正确绑定

**Q: 翻译功能失败？**
A: 翻译API为可选功能，失败时自动返回原文，不影响主要功能

### 调试方法
1. **打开浏览器开发者工具**
2. **查看Console选项卡**
3. **检查错误信息和日志**
4. **验证API调用状态**

## 📞 技术支持

如需技术支持或功能定制，请提供：
- 错误信息截图
- 浏览器控制台日志
- 具体的使用场景描述

## 🔄 更新日志

### v1.0.0 (当前版本)
- ✅ 完整的提示词优化功能
- ✅ 空格触发检测机制
- ✅ 多模型适配支持
- ✅ 响应式设计
- ✅ 主题切换支持
- ✅ 错误处理和用户反馈
- ✅ 独立角色提示词文件

---

**🎉 恭喜！您的 RTPic 项目现已具备专业的提示词优化功能！**

这个功能将大大提升您的AI图像生成体验，帮助您创建更加专业和吸引人的电商产品主图。